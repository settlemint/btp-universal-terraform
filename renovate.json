{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:base"],
  "labels": ["dependencies"],
  "rangeStrategy": "bump",
  "timezone": "UTC",
  "enabledManagers": ["terraform", "regex"],
  "packageRules": [
    {
      "matchManagers": ["terraform"],
      "semanticCommitType": "chore",
      "semanticCommitScope": "deps"
    },
    {
      "matchManagers": ["regex"],
      "semanticCommitType": "chore",
      "semanticCommitScope": "helm"
    },
    {
      "matchManagers": ["terraform", "regex"],
      "matchUpdateTypes": ["patch"],
      "automerge": true,
      "automergeType": "branch"
    }
  ],
  "regexManagers": [
    {
      "fileMatch": ["^deps/ingress_tls/variables\\.tf$"],
      "matchStrings": [
        "variable\\s+\"nginx_chart_version\"[\\s\\S]*?default\\s*=\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "helm",
      "registryUrlsTemplate": ["https://kubernetes.github.io/ingress-nginx"],
      "packageNameTemplate": "ingress-nginx/ingress-nginx"
    },
    {
      "fileMatch": ["^deps/ingress_tls/variables\\.tf$"],
      "matchStrings": [
        "variable\\s+\"cert_manager_chart_version\"[\\s\\S]*?default\\s*=\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "helm",
      "registryUrlsTemplate": ["https://charts.jetstack.io"],
      "packageNameTemplate": "jetstack/cert-manager"
    },
    {
      "fileMatch": ["^deps/postgres/variables\\.tf$"],
      "matchStrings": [
        "variable\\s+\"chart_version\"[\\s\\S]*?default\\s*=\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "helm",
      "registryUrlsTemplate": ["https://charts.bitnami.com/bitnami"],
      "packageNameTemplate": "bitnami/postgresql"
    },
    {
      "fileMatch": ["^deps/redis/variables\\.tf$"],
      "matchStrings": [
        "variable\\s+\"chart_version\"[\\s\\S]*?default\\s*=\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "helm",
      "registryUrlsTemplate": ["https://charts.bitnami.com/bitnami"],
      "packageNameTemplate": "bitnami/redis"
    },
    {
      "fileMatch": ["^deps/object_storage/variables\\.tf$"],
      "matchStrings": [
        "variable\\s+\"chart_version\"[\\s\\S]*?default\\s*=\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "helm",
      "registryUrlsTemplate": ["https://charts.bitnami.com/bitnami"],
      "packageNameTemplate": "bitnami/minio"
    },
    {
      "fileMatch": ["^deps/metrics_logs/variables\\.tf$"],
      "matchStrings": [
        "variable\\s+\"kp_stack_chart_version\"[\\s\\S]*?default\\s*=\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "helm",
      "registryUrlsTemplate": ["https://prometheus-community.github.io/helm-charts"],
      "packageNameTemplate": "prometheus-community/kube-prometheus-stack"
    },
    {
      "fileMatch": ["^deps/metrics_logs/variables\\.tf$"],
      "matchStrings": [
        "variable\\s+\"loki_stack_chart_version\"[\\s\\S]*?default\\s*=\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "helm",
      "registryUrlsTemplate": ["https://grafana.github.io/helm-charts"],
      "packageNameTemplate": "grafana/loki-stack"
    },
    {
      "fileMatch": ["^deps/oauth/variables\\.tf$"],
      "matchStrings": [
        "variable\\s+\"chart_version\"[\\s\\S]*?default\\s*=\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "helm",
      "registryUrlsTemplate": ["https://charts.bitnami.com/bitnami"],
      "packageNameTemplate": "bitnami/keycloak"
    },
    {
      "fileMatch": ["^deps/secrets/variables\\.tf$"],
      "matchStrings": [
        "variable\\s+\"chart_version\"[\\s\\S]*?default\\s*=\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "helm",
      "registryUrlsTemplate": ["https://helm.releases.hashicorp.com"],
      "packageNameTemplate": "hashicorp/vault"
    }
  ]
}
